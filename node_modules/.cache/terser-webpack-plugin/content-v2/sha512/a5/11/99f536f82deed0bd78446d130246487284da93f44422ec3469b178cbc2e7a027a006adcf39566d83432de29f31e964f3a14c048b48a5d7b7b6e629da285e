{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{674:function(s,t,n){\"use strict\";n.r(t);var e=n(10),a=Object(e.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[n(\"blockquote\",[n(\"p\",[s._v(\"几经折腾，本站终于实现https加密了。下面将分享我是如何实现https全站加密的。\")])]),s._v(\" \"),n(\"p\",[s._v(\"首先需要申请一个SSL证书，我的SSL证书是在阿里云免费申请的。\")]),s._v(\" \"),n(\"p\",[s._v(\"申请好证书后，接下来就是如何安装SSL证书和如何在Nginx服务器端进行配置。\")]),s._v(\" \"),n(\"p\",[s._v(\"一、将申请的证书文件上传到服务器\")]),s._v(\" \"),n(\"p\",[s._v(\"使用Xshell连接到远程服务器，在 \"),n(\"code\",[s._v(\"/usr/local/nginx/\")]),s._v(\" 目录下创建 \"),n(\"code\",[s._v(\"cert\")]),s._v(\" 文件夹\")]),s._v(\" \"),n(\"p\",[s._v(\"下载申请的ssl证书（一般包含两个文件，一个.pem和一个.key），上传至刚创建的 \"),n(\"code\",[s._v(\"cert\")]),s._v(\"文件夹内。\")]),s._v(\" \"),n(\"p\",[s._v(\"二、配置\"),n(\"code\",[s._v(\"nginx.conf\")])]),s._v(\" \"),n(\"p\",[s._v(\"首先在 \"),n(\"code\",[s._v(\"/usr/local/nginx/conf/\")]),s._v(\" 目录下找到 \"),n(\"code\",[s._v(\"nginx.conf\")]),s._v(\" 文件，\")]),s._v(\" \"),n(\"p\",[s._v(\"将 \"),n(\"code\",[s._v(\"listen 80;\")]),s._v(\" 改为 \"),n(\"code\",[s._v(\"listen 443;\")]),s._v(\" 其它 \"),n(\"code\",[s._v(\"server_name，index，root\")]),s._v(\" 等都不需要改动；\")]),s._v(\" \"),n(\"p\",[s._v(\"然后再在server段中添加以下代码：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-nginx line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-nginx\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[s._v(\"on\")])]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl_certificate\")]),s._v(\"   /usr/local/nginx/cert/214036733780684.pem\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl_certificate_key\")]),s._v(\"  /usr/local/nginx/cert/214036733780684.key\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl_session_timeout\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"5m\")])]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl_ciphers\")]),s._v(\" ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl_protocols\")]),s._v(\" TLSv1 TLSv1.1 TLSv1.2\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ssl_prefer_server_ciphers\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[s._v(\"on\")])]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\")])]),n(\"p\",[s._v(\"特别需要注意的是：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-nginx line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-nginx\"}},[n(\"code\",[s._v(\"ssl_certificate  \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这一行的路径一定需要填写正确，是绝对路径（以 / 开始），就是指具体在服务器的哪个位置；214036733780684.pem，这个文件名的一段数字就是指申请的ssl证书名，不能填写错误\")]),s._v(\"\\n\\nssl_certificate_key` :同上。\\n\\nssl_session_timeout   5m  \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 不修改\")]),s._v(\"\\n\\nssl_ciphers  \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 改为自己的；\")]),s._v(\"\\n\\nssl_protocols TLSv1 TLSv1.1 TLSv1.2  \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 不需要改动\")]),s._v(\"\\n\\nssl_prefer_server_ciphers on  \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 不需要改动。\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\")])]),n(\"p\",[s._v(\"配置完后如下：\")]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://conimi.com/files/images/screenshots/ssl-nginx-conf.png\",alt:\"ssl-2\"}})]),s._v(\" \"),n(\"p\",[s._v(\"三、单个站点 \"),n(\"code\",[s._v(\"yourdomain.conf\")]),s._v(\" 文件的配置\")]),s._v(\" \"),n(\"p\",[s._v(\"在 \"),n(\"code\",[s._v(\"/usr/local/nginx/conf/vhost/\")]),s._v(\" 目录下找到需要配置的文件，比如 \"),n(\"code\",[s._v(\"www.conimi.com.conf\")])]),s._v(\" \"),n(\"p\",[s._v(\"在server段只需修改 listen 端口为443即可;`\")]),s._v(\" \"),n(\"p\",[s._v(\"修改完成后，就可以通过\"),n(\"code\",[s._v(\"https://www.conimi.com\")]),s._v(\" 和 \"),n(\"code\",[s._v(\"https://conimi.com\")]),s._v(\" 访问了\")]),s._v(\" \"),n(\"p\",[s._v(\"进一步将\"),n(\"code\",[s._v(\"https://conimi.com\")]),s._v(\" 设置301重定向跳转至\"),n(\"code\",[s._v(\"https://www.conimi.com\")])]),s._v(\" \"),n(\"p\",[s._v(\"新建一个server段配置，\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-nginx line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-nginx\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"server\")])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"listen\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"443\")])]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"server_name\")]),s._v(\" conimi.com\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"rewrite\")]),s._v(\" ^(.*) https://www.conimi.com\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$1\")]),s._v(\" permanent\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\")])]),n(\"p\",[s._v(\"就完成了  \"),n(\"code\",[s._v(\"https://conimi.com 301\")]),s._v(\"重定向至\"),n(\"code\",[s._v(\"https://www.conimi.com\")])]),s._v(\" \"),n(\"p\",[s._v(\"以下是配置好的 \"),n(\"code\",[s._v(\"https://conimi.com 301\")]),s._v(\"重定向至 \"),n(\"code\",[s._v(\"https://www.conimi.com\")]),s._v(\"，特别需要注意两个server段的 server_name。\")]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://conimi.com/files/images/screenshots/ssl-vhost-nginx-conf-f.png\",alt:\"ssl-3\"}})]),s._v(\" \"),n(\"p\",[s._v(\"至此，站点就完成了https全站加密，但是，我们很多时候会通过\"),n(\"code\",[s._v(\"http://www.conimi.com\")]),s._v(\"和\"),n(\"code\",[s._v(\"http://conimi.com\")]),s._v(\"访问，于是，我们还需要做一个301重定向，将\"),n(\"code\",[s._v(\"http://www.conimi.com\")]),s._v(\"和\"),n(\"code\",[s._v(\"http://conimi.com\")]),s._v(\"跳转至\"),n(\"code\",[s._v(\"https://www.conimi.com\")])]),s._v(\" \"),n(\"p\",[s._v(\"再新建一个server段，配置如下：\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-nginx line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-nginx\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"server\")])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"listen\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"80\")])]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"server_name\")]),s._v(\" www.conimi.com conimi.com\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"rewrite\")]),s._v(\" ^(.*) https://www.conimi.com\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$1\")]),s._v(\" permanent\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\")])]),n(\"p\",[s._v(\"于是就完成了 \"),n(\"code\",[s._v(\"http://www.conimi.com\")]),s._v(\"和\"),n(\"code\",[s._v(\"http://conimi.com\")]),s._v(\" 跳转到 \"),n(\"code\",[s._v(\"https://www.conimi.com\")])]),s._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:\"https://conimi.com/files/images/screenshots/ssl-vhost-nginx-conf-s.png\",alt:\"ssl-vhost-nginx-conf-s\"}})]),s._v(\" \"),n(\"p\",[s._v(\"四、重启服务器。\")]),s._v(\" \"),n(\"p\",[s._v(\"完成以上配置后，重新启动服务器，我们就可以通过\"),n(\"code\",[s._v(\"http://www.conimi.com、http://conimi.com、https://conimi.com\")]),s._v(\"和\"),n(\"code\",[s._v(\"https://www.conimi.com\")]),s._v(\"访问了。\")]),s._v(\" \"),n(\"p\",[s._v(\"五、可能会出现的问题：\")]),s._v(\" \"),n(\"p\",[s._v(\"能通过https访问，但是浏览器还是显示为不安全，这就需要检查你的网站的资源链接如图片路径，歌曲链接，头像链接等是否为https路径，如果不是，则需要改为https，否则依旧会显示不安全。\")]),s._v(\" \"),n(\"p\",[s._v(\"因此在以后添加图像资源等时，特别需要注意链接是否为https。\")])])}),[],!1,null,null,null);t.default=a.exports}}]);","extractedComments":[]}