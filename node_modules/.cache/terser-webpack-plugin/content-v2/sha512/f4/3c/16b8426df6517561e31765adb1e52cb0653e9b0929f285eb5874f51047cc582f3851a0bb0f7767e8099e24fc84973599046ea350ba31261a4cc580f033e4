{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{732:function(s,a,n){\"use strict\";n.r(a);var t=n(10),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[n(\"h2\",{attrs:{id:\"_0x00-环境准备-nginx安装了lua模块\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x00-环境准备-nginx安装了lua模块\"}},[s._v(\"#\")]),s._v(\" 0x00 环境准备，nginx安装了lua模块\")]),s._v(\" \"),n(\"ul\",[n(\"li\",[s._v(\"可先按照以下方式编译安装lua模块\")]),s._v(\" \"),n(\"li\",[s._v(\"Docker源码编译Nginx[可指定模块]：\"),n(\"a\",{attrs:{href:\"https://conimi.com/archives/109\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://conimi.com/archives/109\"),n(\"OutboundLink\")],1)]),s._v(\" \"),n(\"li\",[s._v(\"目录结构遵循上篇博客：Docker源码编译Nginx[可指定模块]\")])]),s._v(\" \"),n(\"h2\",{attrs:{id:\"_0x01-下载ngx-metric\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x01-下载ngx-metric\"}},[s._v(\"#\")]),s._v(\" 0x01 下载ngx_metric\")]),s._v(\" \"),n(\"p\",[s._v(\"ngx_metric地址：https://github.com/GuyCheung/falcon-ngx_metric\")]),s._v(\" \"),n(\"p\",[s._v(\"nginx目录下文件结构应为，只增加了\"),n(\"code\",[s._v(\"falcon-ngx_metric\")]),s._v(\"文件夹\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[n(\"code\",[s._v(\"nginx\\n    - conf.d\\n    - falcon-ngx_metric\\n    -- lua\\n        --- ngx_metric\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"还有其它文件，不列出了\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\"\\n        *** ngx_metric.lua\\n        *** ngx_metric_output.lua\\n    ** ngx_metric.conf\\n    ** nginx_collect.py\\n    - log\\n    * Dockerfile\\n    * nginx.conf\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 约定：\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    - 表示目录\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#    * 表示文件\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\")])]),n(\"h2\",{attrs:{id:\"_0x02-修改dockerfile\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x02-修改dockerfile\"}},[s._v(\"#\")]),s._v(\" 0x02 修改Dockerfile\")]),s._v(\" \"),n(\"p\",[s._v(\"由于需要python环境，所以安装python\")]),s._v(\" \"),n(\"p\",[s._v(\"Dockerfile内容如下\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-dockerfile line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-dockerfile\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"FROM\")]),s._v(\" debian:10.2-slim\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" maintainer=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"info@fabiocicerchia.it\"')])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" Author=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://github.com/fabiocicerchia/nginx-lua/blob/master/nginx/1.18.0/debian/10.2-slim\"')])]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ARG\")]),s._v(\" BUILD_DATE\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ARG\")]),s._v(\" BUILD_VERSION\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ARG\")]),s._v(\" VCS_REF\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.schema-version=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"1.0\"')])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.build-date=\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$BUILD_DATE\")])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.name=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"fabiocicerchia/nginx-lua\"')])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.description=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"Nginx 1.18.0 with LUA support based on debian 10.2-slim.\"')])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.url=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://github.com/fabiocicerchia/nginx-lua\"')])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.vcs-url=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"https://github.com/fabiocicerchia/nginx-lua\"')])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.vcs-ref=\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$VCS_REF\")])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.version=\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$BUILD_VERSION\")])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"LABEL\")]),s._v(\" org.label-schema.docker.cmd=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"docker run -p 80:80 -d fabiocicerchia/nginx-lua:1.18.0-debian10.2-slim\"')])]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/luajit2\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUAJIT 2.1-20200102\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/lua-nginx-module\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Production ready.\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUA_NGINX_MODULE 0.10.15\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/lua-resty-core\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# This library is production ready.\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUA_RESTY_CORE 0.1.17\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LUA_LIB_DIR /usr/local/share/lua/5.1\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/openresty/lua-resty-lrucache\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# This library is considered production ready.\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_LUA_RESTY_LRUCACHE 0.09\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/nginx/nginx\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_NGINX 1.18.0\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/vision5/ngx_devel_kit\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# The NDK is now considered to be stable.\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_NGX_DEVEL_KIT 0.3.1\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# https://github.com/Yelp/dumb-init\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" VER_DUMBINIT 1.2.2\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LUAJIT_LIB /usr/local/lib\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LUAJIT_INC /usr/local/include/luajit-2.1\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" LD_LIBRARY_PATH /usr/local/lib/:\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"$LD_LIBRARY_PATH\")])]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENV\")]),s._v(\" DEBIAN_FRONTEND noninteractive\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"RUN\")]),s._v(\" set -x \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get update \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    ca-certificates \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    libgeoip-dev \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    libpcre3-dev \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    libssl-dev \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    zlib1g-dev \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    curl \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    g++ \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    gzip \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    make \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    tar \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"## 添加的python和pip环境\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    python2.7 \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    python-pip \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& pip2 install requests \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get remove -y python-pip \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get autoremove -y  \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get autoclean -y  \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# OpenResty LUAJIT2\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /luajit.tar.gz https://github.com/openresty/luajit2/archive/v\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUAJIT}\")]),s._v(\".tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /luajit.tar.gz && rm /luajit.tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /luajit2-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUAJIT}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd / \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# LUA Resty Core\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /lua-resty-core.tar.gz https://github.com/openresty/lua-resty-core/archive/v\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_CORE}\")]),s._v(\".tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /lua-resty-core.tar.gz && rm /lua-resty-core.tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /lua-resty-core-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_CORE}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd / \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# LUA Resty LRUCache\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /lua-resty-lrucache.tar.gz https://github.com/openresty/lua-resty-lrucache/archive/v\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_LRUCACHE}\")]),s._v(\".tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /lua-resty-lrucache.tar.gz && rm /lua-resty-lrucache.tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /lua-resty-lrucache-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_LRUCACHE}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd / \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# NGX Devel Kit\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /ngx_devel_kit.tar.gz https://github.com/vision5/ngx_devel_kit/archive/v\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGX_DEVEL_KIT}\")]),s._v(\".tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /ngx_devel_kit.tar.gz && rm /ngx_devel_kit.tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Lua Nginx Module\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /lua-nginx.tar.gz https://github.com/openresty/lua-nginx-module/archive/v\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_NGINX_MODULE}\")]),s._v(\".tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /lua-nginx.tar.gz && rm /lua-nginx.tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# NGINX\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# create nginx user/group first, to be consistent throughout docker variants\")]),s._v(\"\\n&& addgroup --system --gid 32548 nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& adduser --system --disabled-login --ingroup nginx --no-create-home --home /nonexistent --gecos \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"nginx user\"')]),s._v(\" --shell /bin/false --uid 32548 nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# we're on an architecture upstream doesn't officially build for\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# let's build binaries from the published packaging sources\")]),s._v(\"\\n    && curl -Lo /nginx.tar.gz https://nginx.org/download/nginx-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGINX}\")]),s._v(\".tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && tar xvzf /nginx.tar.gz && rm /nginx.tar.gz \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && cd /nginx-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGINX}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && mkdir -p /var/cache/nginx/client_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/proxy_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/fastcgi_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/uwsgi_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        /var/cache/nginx/scgi_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && ./configure \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --prefix=/etc/nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --sbin-path=/usr/sbin/nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --modules-path=/usr/lib/nginx/modules \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --conf-path=/etc/nginx/nginx.conf \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --error-log-path=/var/log/nginx/error.log \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-log-path=/var/log/nginx/access.log \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --pid-path=/var/run/nginx.pid \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --lock-path=/var/run/nginx.lock \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-client-body-temp-path=/var/cache/nginx/client_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-proxy-temp-path=/var/cache/nginx/proxy_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --http-scgi-temp-path=/var/cache/nginx/scgi_temp \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --user=nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --group=nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-compat \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-file-aio \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-threads \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_addition_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_auth_request_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_dav_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_flv_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_gunzip_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_gzip_static_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_mp4_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_random_index_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_realip_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_secure_link_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_slice_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_ssl_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_stub_status_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_sub_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_v2_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-mail \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-mail_ssl_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream_realip_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream_ssl_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-stream_ssl_preread_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-cc-opt=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'-g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fPIC'\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-ld-opt=\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"'-Wl,-z,relro -Wl,-z,now -Wl,--as-needed -pie'\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --add-module=/lua-nginx-module-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_NGINX_MODULE}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --add-module=/ngx_devel_kit-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGX_DEVEL_KIT}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_dav_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n        --with-http_geoip_module \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make -j \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"$(nproc)\"')]),s._v(\" build \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    && make install \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Bring in tzdata so users could set the timezones through the environment\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# variables\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests tzdata \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Bring in curl and ca-certificates to make registering on DNS SD easier\")]),s._v(\"\\n&& apt-get install -y --no-install-recommends --no-install-suggests curl ca-certificates \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# forward request and error logs to docker log collector\")]),s._v(\"\\n&& ln -sf /dev/stdout /var/log/nginx/access.log \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& ln -sf /dev/stderr /var/log/nginx/error.log \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# dumb-init\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& curl -Lo /usr/bin/dumb-init https://github.com/Yelp/dumb-init/releases/download/v\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_DUMBINIT}\")]),s._v(\"/dumb-init_\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_DUMBINIT}\")]),s._v(\"_x86_64 \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& chmod +x /usr/bin/dumb-init \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Cleanup\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# ##############################################################################\")]),s._v(\"\\n&& rm -rf /lua-nginx-module-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_NGINX_MODULE}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /lua-resty-core-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_CORE}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /lua-resty-lrucache-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUA_RESTY_LRUCACHE}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /luajit2-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_LUAJIT}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /nginx-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGINX}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /ngx_devel_kit-\"),n(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[s._v(\"${VER_NGX_DEVEL_KIT}\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get autoremove -y \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& apt-get remove -y \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    curl \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    g++ \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n    make \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"\\\\\")]),s._v(\"\\n&& rm -rf /var/lib/apt/lists/*\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"HEALTHCHECK\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token options\"}},[n(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v(\"--interval\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"30s\")]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v(\"--timeout\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"=\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v(\"3s\")])]),s._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"CMD\")]),s._v(\" curl --fail http://localhost/ || exit 1\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"EXPOSE\")]),s._v(\" 80\")]),s._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"EXPOSE\")]),s._v(\" 443\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"STOPSIGNAL\")]),s._v(\" SIGTERM\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"ENTRYPOINT\")]),s._v(\" [\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"dumb-init\"')]),s._v(\"]\")]),s._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token instruction\"}},[n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"CMD\")]),s._v(\" [\"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"nginx\"')]),s._v(\", \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"-g\"')]),s._v(\", \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"daemon off;\"')]),s._v(\"]\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"50\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"51\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"52\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"53\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"54\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"55\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"56\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"57\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"58\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"59\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"60\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"61\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"62\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"63\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"64\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"65\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"66\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"67\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"68\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"69\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"70\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"71\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"72\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"73\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"74\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"75\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"76\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"77\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"78\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"79\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"80\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"81\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"82\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"83\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"84\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"85\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"86\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"87\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"88\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"89\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"90\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"91\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"92\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"93\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"94\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"95\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"96\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"97\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"98\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"99\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"100\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"101\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"102\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"103\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"104\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"105\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"106\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"107\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"108\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"109\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"110\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"111\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"112\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"113\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"114\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"115\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"116\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"117\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"118\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"119\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"120\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"121\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"122\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"123\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"124\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"125\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"126\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"127\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"128\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"129\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"130\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"131\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"132\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"133\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"134\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"135\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"136\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"137\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"138\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"139\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"140\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"141\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"142\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"143\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"144\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"145\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"146\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"147\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"148\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"149\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"150\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"151\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"152\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"153\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"154\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"155\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"156\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"157\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"158\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"159\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"160\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"161\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"162\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"163\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"164\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"165\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"166\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"167\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"168\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"169\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"170\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"171\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"172\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"173\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"174\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"175\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"176\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"177\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"178\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"179\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"180\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"181\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"182\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"183\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"184\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"185\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"186\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"187\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"188\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"189\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"190\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"191\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"192\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"193\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"194\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"195\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"196\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"197\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"198\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"199\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"200\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"201\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"202\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"203\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"204\")]),n(\"br\")])]),n(\"h2\",{attrs:{id:\"_0x03-编写docker-comopose文件\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x03-编写docker-comopose文件\"}},[s._v(\"#\")]),s._v(\" 0x03 编写docker-comopose文件\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-docker line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-docker\"}},[n(\"code\",[s._v('version: \"3.7\"\\n\\nservices:\\n    nginx:\\n        build:\\n            context: .\\n            dockerfile: compose/nginx/Dockerfile\\n        restart: always\\n        container_name: nginx\\n        volumes:\\n            - ./wwwroot/demo:/home/wwwroot\\n            - ./compose/nginx/conf.d:/etc/nginx/conf.d\\n            - ./compose/nginx/nginx.conf:/etc/nginx/nginx.conf\\n            - ./compose/nginx/log:/var/log/nginx\\n            '),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 安装ngx_metric\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这里由于容器内不存在modules文件夹，所以可以直接映射，\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 如果容器内存在moduls文件夹且还要其它文件，那么这里就需要将lua文件夹下的内容一个一个文件映射\")]),s._v(\"\\n            - ./compose/nginx/falcon-ngx_metric/lua:/etc/nginx/modules\\n            - ./compose/nginx/falcon-ngx_metric/ngx_metric.conf:/etc/nginx/conf.d/ngx_metric.conf\\n            - ./compose/nginx/falcon-ngx_metric/nginx_collect.py:/opt/nginx_collect.py\\n\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 需要注意：主机文件挂载到容器内存在几种形式\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 1. 用主机内的文件替换容器内的文件，比如容器内存在nginx.conf，主机内也存在nginx.conf，\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这时需要用容器的文件代替主机文件，./compose/nginx/nginx.conf:/etc/nginx/nginx.conf就会覆盖容器内的原有文件\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 2. 将主机文件夹下的文件全部挂载到容器内，比如将主机内的/home/wwwroot/demo下的所有文件映射到容器，\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 这时./wwwroot/demo:/home/wwwroot就会在容器内创建一个/home/wwwroot文件夹，主机demo文件夹内的所有文件都会映射到容器/home/wwwroot文件夹下\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 3. 将容器内的文件夹挂载到主机，比如容器内/var/log/nginx文件下的日志文件会全部映射到主机./compose/nginx/log文件夹下\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 4. 将主机内的文件挂载到容器内，即使容器内不存在需要挂载的文件，比如：容器内/etc/nginx/conf.d/文件夹下不存在ngx_metric.conf,\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 但也要注意要写出容器内的文件名，./compose/nginx/falcon-ngx_metric/ngx_metric.conf:/etc/nginx/conf.d/ngx_metric.conf，\")]),s._v(\"\\n            \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 两边都有ngx_metric.conf文件名\")]),s._v('\\n\\n        ports:\\n            - \"80:80\"\\n\\n        '),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# command: \")]),s._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#     - bash\")]),s._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#     - -c\")]),s._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#     - |\")]),s._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#         sleep 20s\")]),s._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"#         python2.7 /opt/nginx_collect.py --format=falcon --falcon-addr=http://116.62.39.165:1988/v1/push --service=ok_nginx\")]),s._v(\"\\n\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# --falcon-addr 为agent地址\")]),s._v(\"\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),n(\"br\")])]),n(\"h2\",{attrs:{id:\"_0x04-添加定时命令-自动推送\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_0x04-添加定时命令-自动推送\"}},[s._v(\"#\")]),s._v(\" 0x04 添加定时命令，自动推送\")]),s._v(\" \"),n(\"p\",[s._v(\"运行命令\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[n(\"code\",[s._v(\"    python2.7 /opt/nginx_collect.py --format\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"falcon --use-ngx-host --falcon-addr\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"http://116.62.39.165:1988/v1/push\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\")])]),n(\"p\",[s._v(\"参数说明\")]),s._v(\" \"),n(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# Github地址：https://github.com/GuyCheung/falcon-ngx_metric\")]),s._v(\"\\n\\n--use-ngx-host: 使用nginx配置里的service_name作为采集项的endpoint\\n\\n--service: 手动设置endpoint值，当指定--use-ngx-host时，该参数无效\\n\\n--format: 采集数据输出格式，对接falcon请使用--format\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"falcon\\n\\n--falcon-step: falcon step设置，请设置为python脚本调用频率，默认是60\\n\\n--falcon-addr: falcon push接口设置，设置该参数数据直接推送，不再输出到终端。需要安装requests模块\\n\")])]),s._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),n(\"br\")])])])}),[],!1,null,null,null);a.default=e.exports}}]);","extractedComments":[]}